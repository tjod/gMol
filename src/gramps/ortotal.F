C *************************************************************
C This file contains source code for the gMol computer program
C  Copyright (C) 1981-2010 by TJ O'Donnell and
C  Copyright (C) 2005-2010 gNova, Inc.
C It is unlawful to modify or remove this copyright notice.
C See the accompanying LICENSE file for further information. 
C *************************************************************
      SUBROUTINE ORTOTAL(IOBJ)
C
      IMPLICIT NONE
C
#include "UDLIST.FOR"
	INTEGER IOBJ
C
	INTEGER TOTAL, I, J
C
C       THIS IS A GRAMPS UTILITY ROUTINE.
C       THIS SUBROUTINE OPERATES ON THE WORDS IN THE ARRAYS
C       THAT STORE THE BITS FOR DEVICES OR FUNCTIONS
C       ASSIGNED TO EACH
C       TRANSFORMATION.  FOR EACH OBJECT THESE WORDS ARE
C       "OR"ED TOGETHER YIELDING A SUMMARY WORD WHICH REFLECTS
C       WHETHER A PARTICULAR DEVICE IS BEING USED BY THIS
C       OBJECT FOR ANY TRANSFORMATION.
C
C       THIS SUMMARY WORD SPEEDS UP PROCESSING OF EACH OBJECT
C       BY THE DEVSERV/UPDATE PAIR OF SUBROUTINES.
C
      TOTAL=0
      DO 10 J=1,MTFM
      TOTAL=IOR(TOTAL,DEVUSE(J,IOBJ))
 10   CONTINUE
C
C       A WORLD HAS 2 EXTRA TFMS TO CONSIDER
C
      IF(IOBJ.LE.RWORLD)THEN
        DO 15 J=1,WTFM
        TOTAL=IOR(TOTAL,DEVWLD(J,IOBJ))
 15     CONTINUE
        DEVWLD(WSUMMRY,IOBJ)=TOTAL
      END IF
C
C       THE SUMMARY IS UPDATED TO CONTAIN THE TOTAL
C
      DEVUSE(SUMMARY,IOBJ)=TOTAL
C
C       SUMMARIZE THE FUNCTIONS USED BY THE OBJECT, TOO
C
      TOTAL=0
      DO 20 J=1,MTFM
      TOTAL=IOR(TOTAL,FNUSE(J,IOBJ))
 20   CONTINUE
C
C       AND THE FUNCTIONS USED BY THE EXTRA TFMS OF A WORLD
C
      IF(IOBJ.LE.RWORLD)THEN
        DO 25 J=1,WTFM
        TOTAL=IOR(TOTAL,FNWLD(J,IOBJ))
 25     CONTINUE
        FNWLD(WSUMMRY,IOBJ)=TOTAL
      END IF
C
C       THE SUMMARY WORD IS UPDATED
C
      FNUSE(SUMMARY,IOBJ)=TOTAL
C
      RETURN
      END
