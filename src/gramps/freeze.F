C *************************************************************
C This file contains source code for the gMol computer program
C  Copyright (C) 1981-2010 by TJ O'Donnell and
C  Copyright (C) 2005-2010 gNova, Inc.
C It is unlawful to modify or remove this copyright notice.
C See the accompanying LICENSE file for further information. 
C *************************************************************
      SUBROUTINE FREEZE(ARG,SWITCHES)
C
      IMPLICIT NONE
      CHARACTER ARG*(*)
      CHARACTER SWITCHES*(*)
C
#include "UDLIST.FOR"
#include "ERRORS.FOR"
	INTEGER START, FINISH, DEPTH, LEVEL, SIZE
	INTEGER I, N
C
C       THIS ROUTINE FREEZES AN OBJECT BY ZEROING OUT THE
C       SUMMARY WORD FOR DIAL ASSIGNMENTS.  THE ASSIGNMENTS
C       ARE NOT LOST, BUT ONLY IGNORED BY UPDATES UNTIL THE ORTOTAL
C       ROUTINE IS CALLED TO SUMMARIZE THE DEV USE OF AN OBJ.
C
C       GET THE OBJ NAME
C
      POINT=1
 10   CALL NAMID(ARG,POINT,ID)
      IF(ERROR.NE.0)CALL TELLUSER(ERROR,*999)
C
      DEVUSE(SUMMARY,ID)=0
C
C       IF ITS A GROUP, ALL MEMBERS MAY BE FROZEN IF THE
C       /GROUP SWITCH IS SPECIFIED.
C
      IF( (TYPOBJ(ID).EQ.GROUP).AND.MATCH(SWITCHES,'GROUP') )THEN
        CALL GROUPINFO(ID,START,FINISH,DEPTH,LEVEL,SIZE)
        DO 20 I=START+1,FINISH
        N=TREE(I)
        IF(N.GT.GROUPEND)DEVUSE(SUMMARY,N)=0
 20     CONTINUE
      END IF
C
C       MORE ARGS ARE ALLOWED - GET THEM IF ANY
C
      IF(POINT.NE.0)GOTO 10
 999  RETURN
      END
C
C
      SUBROUTINE RELEASE(ARG,SWITCHES)
C
      IMPLICIT NONE
      CHARACTER ARG*(*)
      CHARACTER SWITCHES*(*)
C
#include "UDLIST.FOR"
#include "ERRORS.FOR"
C
	INTEGER START, FINISH, DEPTH, LEVEL, SIZE
	INTEGER I, N
C
C       THIS ROUTINE UNFREEZES AN OBJ BY CALLING ORTOTAL TO
C       SUMMARIZE THE DEV USE OF AN OBJ AND INSERT IT INTO
C       THE SUMMARY WORD WHICH THE UPDATE PROGRAMS CONSULT.
C
C       GET THE OBJ TO RELEASE
C
      POINT=1
 10   CALL NAMID(ARG,POINT,ID)
      IF(ERROR.NE.0)CALL TELLUSER(ERROR,*999)
C
      CALL ORTOTAL(ID)
C
C       AN ENTIRE GROUP MAY ME RELEASED IF /GROUP IS SPECIFIED.
C
      IF( (TYPOBJ(ID).EQ.GROUP).AND.MATCH(SWITCHES,'GROUP') )THEN
        CALL GROUPINFO(ID,START,FINISH,DEPTH,LEVEL,SIZE)
        DO 20 I=START+1,FINISH
        N=TREE(I)
        IF(N.GT.GROUPEND)THEN
          CALL ORTOTAL(N)
        END IF
 20     CONTINUE
      END IF
C
C       GET MORE ARGS IF ANY
C
      IF(POINT.NE.0)GOTO 10
 999  RETURN
      END
