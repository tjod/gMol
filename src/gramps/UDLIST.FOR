C *************************************************************
C This file contains source code for the gMol computer program
C  Copyright (C) 1981-2010 by TJ O'Donnell and
C  Copyright (C) 2005-2010 gNova, Inc.
C It is unlawful to modify or remove this copyright notice.
C See the accompanying LICENSE file for further information. 
C *************************************************************
C       GRAMPS VERSION NUMBER TO BE PRINTED WITH SHOW/SYSTEM
C
      CHARACTER*40 VERSION
      PARAMETER (VERSION='       GRAMPS          VERSION 3.3')
C
C++++++++++++++++++++++
C#include "UDBUFFS.FOR"
C
C     SIZE OF 1K BYTES
      INTEGER KSIZE
      PARAMETER (KSIZE=1024)
C
C     MAXIMUM UDL SPACE AVAILABLE, THEN
      INTEGER  MAXUDL
      PARAMETER (MAXUDL=50000*KSIZE)
C
C       THIS IS THE SIZE OF THE AREA TO BE USED FOR BUFFERING
C       TRANSFORMED DISPLAY LISTS, READY TO BE OUTPUT
C
      INTEGER  BUFLEN
      PARAMETER (BUFLEN=10000*KSIZE)
C
C       DIMENSION SPACE USED FOR UDL'S AND GIVE AN EXTRA
C       16 WORDS SO THAT WHEN AN ERROR IS DETECTED I CAN
C       END THE OBJECT AND CLEAN UP.
C
      REAL DLIST(MAXUDL+16),USLIST(BUFLEN)
      COMMON /UDLIST/ DLIST
      SAVE   /UDLIST/
      COMMON /TDLIST/ USLIST
      SAVE   /TDLIST/
C++++++++++++++++++++++
C
C     MAXIMUM NUMBER OF OBJECTS
      INTEGER MOBJ
      PARAMETER (MOBJ=500)
C
C     MAXIMUM NUMBER OF OBJECTS + FRAMES
      INTEGER MOBJFR
      PARAMETER (MOBJFR=5000)
C
C       FROM HERE ON,  CHANGE THE PARAMETERS WITH CAUTION.
C       SOME PARMS ARE MORE CASUALLY CHANGED THAN OTHERS.
C       THERE IS MUCH SAFEGUARDING IN GRAMPS AGAINST OVERSTEPPING
C       BOUNDS AND LIMITS SO IF YOU CHANGE A LIMIT GRAMPS
C       WILL PROBABLY NOT CRASH, BUT I'M NOT SURE.
C       YOU SHOULD NOT NEED TO ADJUST PARMS AT ALL, UNLESS
C       YOU DON'T HAVE MUCH MEMORY (FOR UDL BUFFERING, E.G.).
C
C	Maximum # of light source (IRIS limit (GL or hardware?) of 8)
C
	INTEGER NLITES
	PARAMETER (NLITES=8)
C
C	TYPOBJ, LOCOBJ, SIZEOBJ are FUNCTIONs in objutil.f
      INTEGER TYPOBJ, LOCOBJ, SIZEOBJ
c      External TYPOBJ, LOCOBJ, SIZEOBJ
C	Functions in charutil.f
      INTEGER TRIM, SPAN
C     EXTERNAL TRIM, SPAN
      LOGICAL MATCH, SCMP
C     External MATCH, SCMP
C	Command functions
      INTEGER DO
C	Miscellaneous functions
      INTEGER MASTSYN, A2I, NEXTLOC
      REAL A2F
      LOGICAL FRAMECHK, BTEST, WRESET
      INTEGER GETDSK, GETINIT, GETMORE
      INTEGER  OPENFILE, IDNAME
      INTEGER IDFRAM
c      EXTERNAL MASTSYN, NEXTLOC, FRAMECHK
C     EXTERNAL A2I, A2F
C     EXTERNAL BTEST
c      EXTERNAL WRESET
C      EXTERNAL GETDSK, GETINIT, GETMORE
c      EXTERNAL OPENFILE
c      EXTERNAL  IDNAME
c      EXTERNAL IDFRAM
C	C functions
	INTEGER fcopen
	INTEGER fcclose
	INTEGER fcwrite
	INTEGER fcread
	INTEGER trpat
	INTEGER cdone
	INTEGER cinit
	INTEGER cwrite
	INTEGER qwrite
	INTEGER cread
	INTEGER sockclientinit
	INTEGER sockserverinit
	INTEGER sockcheck
	INTEGER sockget
	INTEGER socksend
c	INTEGER sockserverend
c	INTEGER sockclientend
	INTEGER qixsend
	INTEGER qixread
	INTEGER neterr
	INTEGER envget
	INTEGER iopeek
	INTEGER speak
c
c	External qwrite
c	External fcopen
c	External fcclose
c	External fcwrite
c	External fcread
c	External trpat
c	External cdone
c	External cinit
c	External cwrite
c	External qwrite
c	External cread
c	External sockclientinit
c	External sockserverinit
c	External sockcheck
c	External sockget
c	External socksend
c	External sockserverend
c	External sockclientend
c	External qixsend
c	External qixread
c	External neterr
c	External envget
c	External speak
C
C For GROUT
	Integer NO_OUT
	Integer STANDARD_OUT
	Integer QT_OUT
	Integer SOCKET_OUT
	Integer COMMAND_OUT
	Parameter (NO_OUT       = 0)
	Parameter (STANDARD_OUT = 1)
	Parameter (QT_OUT  =  2)
	Parameter (SOCKET_OUT  =  3)
	Parameter (COMMAND_OUT =  4)
C
      INTEGER IDOBJ, KINDOBJ, FRMCNT, OBJFRID, OBJFRLOC,OBJFRSIZ
      COMMON /OBJINFO/
     &       IDOBJ(MOBJ),
     &       KINDOBJ(MOBJ),
     &       FRMCNT(MOBJ),
C
     &       OBJFRID(MOBJFR),
     &       OBJFRLOC(MOBJFR),
     &       OBJFRSIZ(MOBJFR)
      SAVE /OBJINFO/
C
C       MAXIMUM NUMBER OF TYPES OF TRANSFORMATIONS
C       REQUIRES MUCH FORETHOUGHT BEFORE CHANGING.
C
      INTEGER MTFM
      PARAMETER (MTFM=33)
C
C       COMMON AREA FOR INFORMATION ABOUT DEVICES ASSIGNED
C       AND FUNCTIONS USED FOR EACH TFM TYPE FOR EACH OBJ.
C
      REAL  TFMANG
      REAL  DFACT
      INTEGER FNUSE, DEVUSE
C      INTEGER TFMVAL, TFMINC, BOUNDS, AMPL
      REAL TFMVAL, TFMINC, BOUNDS, AMPL
      COMMON  /DEVFN/  TFMANG(MTFM,MOBJ),
     &       DEVUSE(1+MTFM,MOBJ),
     &       FNUSE (1+MTFM,MOBJ),
     &       TFMVAL(MTFM,MOBJ),
     &       TFMINC(MTFM,MOBJ),
     &       BOUNDS(MTFM,MOBJ),
     &       AMPL(MTFM,MOBJ),
     &       DFACT(MTFM,MOBJ)
      SAVE /DEVFN/
C
	INTEGER DIALS, MOUSS, SLIDES, SPINS
	PARAMETER (DIALS=1)
	PARAMETER (MOUSS=256)
	PARAMETER (SLIDES=65536)
	PARAMETER (SPINS=16777216)
C
C       COMMON AREA FOR DEV AND FN ASSIGNMENTS FOR THE 2 WORLDS.
C       MAXIMUM NUMBER OF ADDED TRANSFORMATIONS FOR THE WORLDS
C       ALSO REQUIRES MUCH FORETHOUGHT BEFORE CHANGING.
C
      INTEGER WTFM
      PARAMETER (WTFM=14)
      REAL WLDANG
      REAL DWFACT
      INTEGER FNWLD, DEVWLD
C      INTEGER WLDVAL, WLDINC, BOUNDW, AMPLW
      REAL WLDVAL, WLDINC, BOUNDW, AMPLW
      COMMON /WDEVFN/  WLDANG(WTFM,2),
     &       DEVWLD(1+WTFM,2),
     &       FNWLD (1+WTFM,2),
     &       WLDVAL(WTFM,2),
     &       WLDINC(WTFM,2),
     &       BOUNDW(WTFM,2),
     &       AMPLW(WTFM,2),
     &       DWFACT(WTFM,2)
      SAVE /WDEVFN/
C
C       UDLIMIT IS HERE FOR HISTORICAL REASONS.  THIS VERSION
C       DOESN'T USE IT FOR ANYTHING, SINCE THERE IS NO E&S
C       UDL LIMIT.  HOWEVER, SET SPILL (USELESS, BUT IT REMAINS)
C       WILL CHECK AGAINST THIS LIMIT.  ALSO UDINIT INITIALIZES
C       SPILL TO THIS VALUE.
C
      INTEGER UDLIMIT
      PARAMETER (UDLIMIT=32767)
C
C       THESE EQUIVALENCES ARE TO SAVE SPACE.  THE BOUNDED
C       FUNCTIONS IN GRAMPS (USING LBOUND, UBOUND) CAN NOT
C       OCCURR SIMULTANEOUSLY WITH THE SIN OR LINEAR
C       UPDATING TO A DESTINATION, AND SO THE ARRAYS USED
C       FOR THESE TYPES OF FUCTIONS MAY BE OVERLAYED.
C
C      INTEGER LBOUND(MTFM,MOBJ),UBOUND(MTFM,MOBJ)
      REAL LBOUND(MTFM,MOBJ),UBOUND(MTFM,MOBJ)
      EQUIVALENCE (LBOUND,BOUNDS),(UBOUND,AMPL)
C      INTEGER LWBOUND(WTFM,2),UWBOUND(WTFM,2)
      REAL LWBOUND(WTFM,2),UWBOUND(WTFM,2)
      EQUIVALENCE (LWBOUND,BOUNDW),(UWBOUND,AMPLW)
C
C       THE MAXIMUM NUMBER OR COORD VARIABLES ALLOWED.
C       THIS PARAMETER SHOULD BE FREELY CHANGEABLE,
C       THOUGHT I HAVEN'T TRIED IT AND UNFORSEEN PROBLEMS
C       COULD ARISE FROM A CHANGE IN ITS VALUE.
C
      INTEGER NCOORDS
      PARAMETER (NCOORDS=10)
      REAL UCOORD(4,NCOORDS)
      COMMON /IVARS/ UCOORD
      SAVE /IVARS/
C
C       SPACE FOR FIX MATRICES FOR OBJECTS.
C
      REAL FIXMAT(4,4,MOBJ)
      COMMON /FMATS/FIXMAT
      SAVE /FMATS/
C
C       PLACE FOR ARBITRARY AXIS MATRICES.
C
      REAL ARBMAT(4,4,MOBJ),IARBMAT(4,4,MOBJ)
      COMMON /MATARB/ARBMAT,IARBMAT
      SAVE /MATARB/
C
C       MISCELLANEOUS FLAGS AND VALUES OF GENERAL USE TO
C       TO VARIOUS GRAMPS ROUTINES.
C
C++++++++++++++++++
C#include "MISC.FOR"
C****************************************************************
C
C (C) Copyright 1981, 1988  TJ O'Donnell
C
C****************************************************************
      REAL FPAUSE,ADSENS
C
      INTEGER UDFREE,USSIZE
      INTEGER NDDISP,NOBJ,NIDS,NFRAMES,TREEEND
      INTEGER LENGTH,GFILE,AGF,ERROR,STEREO
      INTEGER GRNUM,DRAWEE,SPILL,MAXDEPTH,WAITING
      INTEGER PICKECHO,BUFNUM,BUFMAX,MPSERR,FCOUNT
      INTEGER POINT,ARGSTART,NPOINT,HITSYM,HITCOORD
      INTEGER MENUEND,MSSIZE,VERLVL,TREELVL,XTEND
      INTEGER CLOOP,LPDEEP,CONDMODE,UDSTART,RUBBER
      INTEGER OUTTING,CLSPOT,CMDFROM,REROUTE
      INTEGER HITTING, HITNOW, HITOBJ
      INTEGER BACKFACE,NADVANCE
      PARAMETER (HITNOW=-1)
C
      LOGICAL CONT,PPAUSE,DEVWAIT,VERIFY,MCHANGE,TCHANGE
      LOGICAL DCHANGE,WATCH,COLLECT,SKIPCOLL,DOING
      LOGICAL FULLERR,DRAWING,AUTOCLEAR
      LOGICAL SKIPDISP,SHOWXTREE,ECHO,FILMPAUSE
      LOGICAL REPORT,LOWERCASE,LOOPING
      LOGICAL WINVRT,XGL
      LOGICAL DBLMODE,CURSOR,HIDESMODE,SMOLIN
      LOGICAL SNAPPING
C
C	REAL
C
      COMMON /MISC/  FPAUSE,ADSENS,
C
C       INTEGER
C
     &      UDFREE,USSIZE,HITTING,HITOBJ,
     &      NDDISP,NOBJ,NIDS,NFRAMES,TREEEND,
     &      LENGTH,GFILE,AGF,ERROR,STEREO,GRNUM,
     &      FILMPAUSE,DRAWEE,SPILL,MAXDEPTH,WAITING,
     &      PICKECHO,BUFNUM,BUFMAX,MPSERR,FCOUNT,
     &      POINT,ARGSTART,NPOINT,HITSYM,HITCOORD,
     &      MENUEND,MSSIZE,VERLVL,TREELVL,XTEND,
     &      CLOOP,LPDEEP,CONDMODE,UDSTART,RUBBER,
     &      XGL,OUTTING,CLSPOT,CMDFROM,PFILE,BACKFACE,NADVANCE,
C
C       THEN THE LOGICAL'S
C
     &      CONT,PPAUSE,DEVWAIT,VERIFY,
     &      DCHANGE,MCHANGE,TCHANGE,WATCH,COLLECT,SKIPCOLL,DOING,
     &      FULLERR,DRAWING,AUTOCLEAR,SKIPDISP,
     &      SHOWXTREE,ECHO,LOWERCASE,REPORT,
     &      CURSOR,DBLMODE,
     &      LOOPING,WINVRT,HIDESMODE,SMOLIN,REROUTE,SNAPPING
C
      SAVE   /MISC/
C
C++++++++++++++++++
C
C       THE GENERAL ARGUMENT LIST USED BY THE COMMANDS THAT
C       SET UP TFM'S OF OBJECTS.  USED BY ROTATE, TRANSLATE, ETC.
C       AND USED BY PUTTFM, PUTWTFM.
C
      REAL FACTOR
      LOGICAL ADDIT, GOTVAL, ADDSTEP
      INTEGER ID,DEV,FUNKY
      REAL VAL, STEP
      COMMON /ARGITEM/ ID,DEV,GOTVAL,VAL,ADDIT,FUNKY,STEP, ADDSTEP,
     &       FACTOR
      SAVE /ARGITEM/
C
C
C       THERE SHOULD BE ABSOLUTELY NO REASON TO CHANGE ANY
C       OF THESE PREASSIGNED OBJECT NUMBERS.  CHANGING
C       GROUPEND WOULD BE DISASTROUS, BUT THE OTHERS COULD
C       PROBABLY BE CHANGED.
C
C     OBJECT # FOR LWORLD AND RWORLD
C     OBJECT #'S FOR OTHER SPECIAL OBJECTS
C
      INTEGER LWORLD
      INTEGER RWORLD
      INTEGER GLITE1
      INTEGER GLITE2
      INTEGER GLITE3
      INTEGER GLITE4
      INTEGER GLITE5
      INTEGER GLITE6
      INTEGER GLITE7
      INTEGER GLITE8
      INTEGER BUFBASE
      INTEGER GROUPPOP
      INTEGER TCURS
      INTEGER TPLANE
      INTEGER TCUBE
      INTEGER MENUBUFF
      INTEGER TBOX
      INTEGER LOOPUDL
      INTEGER UDLPUSH
      INTEGER GROUPEND
C
      PARAMETER (LWORLD=1)
      PARAMETER (RWORLD=2)
      PARAMETER (GLITE1=3)
      PARAMETER (GLITE2=4)
      PARAMETER (GLITE3=5)
      PARAMETER (GLITE4=6)
      PARAMETER (GLITE5=7)
      PARAMETER (GLITE6=8)
      PARAMETER (GLITE7=9)
      PARAMETER (GLITE8=10)
      PARAMETER (BUFBASE=32000)
      PARAMETER (GROUPPOP=32766)
      PARAMETER (TCURS=32765)
      PARAMETER (TPLANE=32764)
      PARAMETER (TCUBE=32763)
      PARAMETER (MENUBUFF=32762)
      PARAMETER (TBOX=32761)
      PARAMETER (LOOPUDL=32760)
      PARAMETER (UDLPUSH=32759)
      PARAMETER (GROUPEND=0)
C
C       THIS PARAMETER REFLECTS THE NUMBER OF SPECIAL ID'S
C       THAT ARE INCLUDED IN THE E&S TABLE, BUT ARE NOT
C       AVAILABLE TO GRAMPS USERS.  THESE ARE THOSE OBJS
C       LISTED ABOVE (TCURS, TPLANE, ETC.).  THIS PARAMETER
C       IS USED IN OPENOBJ TO TEST FOR TOO MANY IDS.
C
      INTEGER MESIDS
      PARAMETER (MESIDS=MOBJFR - 8)
C
C       SIZE OF THE DISPLAY TREE.
C       SHOULD BE AT LEAST AS LARGE AND MOBJ AND GREATER
C       IF YOU EXPECT TO USE GROUPING EXTENSIVELY.
C       MAY BE FREELY CHANGED.
C       MITEMS IS THE SIZE OF THE MENU TREE.
C       MAY BE CHANGED.
C
      INTEGER TREESIZE, MITEMS, XTREESIZE
      PARAMETER (TREESIZE=MOBJ+300)
      PARAMETER (MITEMS=50)
      PARAMETER (XTREESIZE=5000)
C
      INTEGER TREE(TREESIZE),MENUTREE(MITEMS),XTREE(XTREESIZE)
      COMMON /THETREE/ TREE,MENUTREE,XTREE
      SAVE /THETREE/
C
C       SPACE TO STORE THE NAMES OF OBJECTS.
C
      INTEGER NAMMAX, MNAMES
      PARAMETER (NAMMAX=40)
      PARAMETER (MNAMES=MOBJ)
      CHARACTER*(NAMMAX) NAMOBJ(MNAMES)
      COMMON /NAMES/ NAMOBJ
      SAVE /NAMES/
C
C       THE TYPES OF OBJECTS.
C       NO REASON TO CHANGE ANY OF THESE ASSIGNMENTS.
C
      INTEGER ORDINARY
      INTEGER FRAME
      INTEGER ONEFRAME
      INTEGER GROUP
      INTEGER WORLD
      INTEGER FRMCELL
      INTEGER LIGHT
      INTEGER NEWCOPY
      INTEGER NEWCOND
C
      PARAMETER (ORDINARY=0)
      PARAMETER (FRAME=1)
      PARAMETER (ONEFRAME=2)
      PARAMETER (GROUP=3)
      PARAMETER (WORLD=4)
      PARAMETER (FRMCELL=5)
      PARAMETER (LIGHT=6)
      PARAMETER (NEWCOPY=-1)
      PARAMETER (NEWCOND=-2)
C
      INTEGER MASTBIT
      INTEGER SYNOBYTE
      INTEGER SYNOBIT
      INTEGER TEXTBYTE
      INTEGER TEXTBIT
      INTEGER MENUBYTE
      INTEGER MENUBIT
      INTEGER RETBYTE
      INTEGER RETBIT
      INTEGER LOOPBYTE
      INTEGER LOOPBIT
      INTEGER DELBYTE
      INTEGER DELBIT
      INTEGER BLNKBYTE
      INTEGER BLNKBIT
      INTEGER CLIPBYTE
      INTEGER CLIPBIT
C
      PARAMETER (MASTBIT=16)
      PARAMETER (SYNOBYTE=32768)
      PARAMETER (SYNOBIT=15)
      PARAMETER (TEXTBYTE=16384)
      PARAMETER (TEXTBIT=14)
      PARAMETER (MENUBYTE=8192)
      PARAMETER (MENUBIT=13)
      PARAMETER (RETBYTE=4096)
      PARAMETER (RETBIT=12)
      PARAMETER (LOOPBYTE=2048)
      PARAMETER (LOOPBIT=11)
      PARAMETER (DELBYTE=1024)
      PARAMETER (DELBIT=10)
      PARAMETER (BLNKBYTE=512)
      PARAMETER (BLNKBIT=9)
      PARAMETER (CLIPBYTE=256)
      PARAMETER (CLIPBIT=8)
C
C       COMMON AREA FOR STORING TEXT STRINGS FOR OBJECTS.
C
C     PARAMETER (MAXCL=100)
C     CHARACTER*80 CHLINE(MAXCL)
C     COMMON /TEXTLINES/CHLINE
C
C       BASE UNIT NUMBER FOR .GIN FILES, MAXIMUM UNIT #
C       COULD BE CHANGED.  THE DIFFERENCE (GFILMAX-GFILMIN+1)
C       DEFINES THE MAXIMUM DEPTH OF GIN FILE NESTING ALLOWED.
C
      INTEGER GFILMIN, GFILMAX
      PARAMETER (GFILMIN=11)
      PARAMETER (GFILMAX=20)
C
C       GFILBAS IS ONE LESS THAN THE GFILMIN SO THAT THE FIRST
C       TIME AROUND, GFILE WILL BE INCREMENTED TO THE MIN VALUE.
C
      INTEGER GFILBASE
      PARAMETER (GFILBASE=GFILMIN-1)
C     DATA GFILE/GFILBASE/
C
C       PARAMETERS FOR GIN FILES: MAX NEST & MAX ARGS.
C       AGFMAX IS THE MAXIMUM NESTING OF DO FILES ALLOWED
C       AND ARGMAX IS THE MAXIMUM ARGS PER DO FILE.
C       AGFMAX IS ONE GREATER THAN THE MAX NESTING SINCE
C       THERE ARE $ARGS DEFINED AT COMMAND LEVEL, TOO.
C
      INTEGER AGFMAX, ARGMAX
      PARAMETER (AGFMAX=GFILMAX-GFILMIN+2)
      PARAMETER (ARGMAX=10)
C
C++++++++++++++++++++
C
C        COLLECT FILE UNIT NUMBER
C
      INTEGER CFILE
      PARAMETER (CFILE=25)
C
C       NAME OF THE CURRENT COLLECT FILE
C
      CHARACTER*255 COLLFILE, RERFILE, SNAPFILE
      COMMON /COLL/COLLFILE, RERFILE, SNAPFILE
      SAVE /COLL/
C
C       UNIT NUMBER FOR PICTURE FILE INPUT
C
      INTEGER PUNIT
      INTEGER PFILE
      PARAMETER (PUNIT=10)
      INTEGER STDIN
      PARAMETER (STDIN=5)
C
C       UNIT NUMBER FOR THE REROUTE FILE.
C
      INTEGER RFILE
      PARAMETER (RFILE=35)
	Integer OFF, PENDING, ACTIVE
	Parameter (OFF=0)
	Parameter (PENDING=1)
	Parameter (ACTIVE=2)
C
C	UNIT NUMBERS FOR HELP FILE
C
      INTEGER HFILE, DFILE
      PARAMETER (HFILE=36)
      PARAMETER (DFILE=37)
C
C       UNIT NUMBER AND FILE NAME OF THE DISPLAY OUTPUT FILE.
C       PARAMETER FOR OUTPUT TYPES AVAILABLE.
C       ALL VALUES GREATER THAN ZERO IMPLY OUTPUT TO A GRAPHICS
C       DEVICE, LESS THAN ZERO IMPLY OUTPUT TO A FILE.
C       THE NIL DEVICE IS AVAILABLE TO TEST THE PATH THROUGH THE
C       VARIOUS SUBROUTINES, ALTHOUGH NO OUTPUT WILL APPEAR, ALL THE
C       MATRIX OPERATIONS ARE PERFORMED.  THIS CAN BE USEFUL FOR
C       TIMING, THAT IS TO TIME THE CPU PERFORMANCE WITHOUT THE
C       OVERHEAD OF DEVICE OR FILE OUTPUT.  OUTNONE SKIPS ALL
C       THE MATRIX CALCULATIONS.  
C
      INTEGER OFILE
      PARAMETER (OFILE=36)
      CHARACTER*255 OUTFILE
      COMMON /DSPOUT/OUTFILE
      SAVE /DSPOUT/
C
      INTEGER OUTASC
      INTEGER OUTPOV
      INTEGER OUTRAYT
      INTEGER OUTRAYS
      INTEGER OUTPOSTSCR
      INTEGER OUTTDL
      INTEGER OUTPIX
      INTEGER OUTQIX
      INTEGER OUTNONE
      INTEGER OUTNIL
      INTEGER OUTTEK4010
      INTEGER OUTRAMTEK
      INTEGER OUTVT220
      INTEGER OUTWINDOW
      INTEGER OUTMAX
C
      PARAMETER (OUTPOV    =-8)
      PARAMETER (OUTASC    =-7)
      PARAMETER (OUTRAYS   =-6)
      PARAMETER (OUTRAYT   =-5)
      PARAMETER (OUTPOSTSCR=-4)
      PARAMETER (OUTTDL    =-3)
      PARAMETER (OUTPIX    =-2)
      PARAMETER (OUTQIX    =-1)
      PARAMETER (OUTNONE    =0)
      PARAMETER (OUTNIL     =1)
      PARAMETER (OUTTEK4010 =2)
      PARAMETER (OUTRAMTEK  =3)
      PARAMETER (OUTVT220   =4)
      PARAMETER (OUTWINDOW  =5)
      PARAMETER (OUTMAX     =5)
C
C       BITS FOR FUNCTION USES.
C       REQUIRES UTMOST CARE WHEN CHANGING!
C
      INTEGER FNEGDEV
      INTEGER FADDINC
      INTEGER FLIMIT
      INTEGER FSIN
      INTEGER FBOUNDED
      INTEGER FBOUNCE
      INTEGER FFACT
      INTEGER FLABROT
      INTEGER FWRAP
      INTEGER FOBJ
      INTEGER FCOORD
C
      INTEGER BNEGDEV
      INTEGER BADDINC
      INTEGER BLIMIT
      INTEGER BSIN
      INTEGER BBOUNDED
      INTEGER BBOUNCE
      INTEGER BFACT
      INTEGER BLABROT
      INTEGER BWRAP
      INTEGER BOBJ
      INTEGER BCOORD
C
      PARAMETER (FNEGDEV=32768)
      PARAMETER (FADDINC=16384)
      PARAMETER (FLIMIT=8192)
      PARAMETER (FSIN=4096)
      PARAMETER (FBOUNDED=2048)
      PARAMETER (FBOUNCE=1024)
      PARAMETER (FFACT=512)
      PARAMETER (FLABROT=256)
      PARAMETER (FWRAP=128)
      PARAMETER (FOBJ=64)
      PARAMETER (FCOORD=32)
C
      PARAMETER (BNEGDEV=15)
      PARAMETER (BADDINC=14)
      PARAMETER (BLIMIT=13)
      PARAMETER (BSIN=12)
      PARAMETER (BBOUNDED=11)
      PARAMETER (BBOUNCE=10)
      PARAMETER (BFACT=9)
      PARAMETER (BLABROT=8)
      PARAMETER (BWRAP=7)
      PARAMETER (BOBJ=6)
      PARAMETER (BCOORD=5)
C
C       WORK SPACE FOR ANY TEMPORARY STORAGE.
C       NO GUARANTEE AS TO CONTENTS OR LIFETIME.
C       CHANGE AMOUNT AT WILL.
C
      INTEGER WORKSIZE
      PARAMETER (WORKSIZE=2000)
      INTEGER WORK(WORKSIZE)
      COMMON/WORKSPACE/WORK
      SAVE /WORKSPACE/
C
C	For STEREO
C
	INTEGER NOSTEREO, ZSTEREO, UDSTEREO, LRSTEREO
	INTEGER FSTEREO, RGSTEREO
	PARAMETER (NOSTEREO=0)
	PARAMETER (LRSTEREO=1)
	PARAMETER (UDSTEREO=2)
	PARAMETER (ZSTEREO=3)
	PARAMETER (FSTEREO=4)
	PARAMETER (RGSTEREO=5)
C
C       THE FOLLOWING PARAMTERS ARE POINTERS FOR
C       MODIFYING THE UNTRANSFORMED DISPLAY LIST
C       REQUIRES UTMOST CARE WHEN CHANGING.
C
       INTEGER UDDASH, UDBLINK
       PARAMETER (UDDASH=3)
       PARAMETER (UDBLINK=6)
C
C       THESE ARE THE SIZES OF OBJECT HEADERS OF
C       COLOR, DASH, BLINK AND INTENSITY INFORMATION.
C       REQUIRES MUCH CARE WHEN CHANGING.
C
      INTEGER HDRSIZE, GROUPSIZE, FRAMESIZE, SYNSIZE
      PARAMETER (HDRSIZE=16)
      PARAMETER (GROUPSIZE=HDRSIZE)
      PARAMETER (FRAMESIZE=HDRSIZE)
      PARAMETER (SYNSIZE=HDRSIZE)
C
C       THE FOLLOWING ARE POINTERS FOR MODIFYING THE
C       DEVUSE, FNUSE, TFMVAL AND TFMINC ARRAYS
C       ALSO REQUIRED EXTREME CARE WHEN CHANGING.
C       THERE SHOULD BE MTFM OF THESE; SUMMARY THEN
C       HAD BETTER EQUAL MTFM+1
C
      INTEGER UTRANX
      INTEGER UTRANY 
      INTEGER UTRANZ 
      INTEGER UTRANW 
      INTEGER UROTXX 
      INTEGER UROTYY 
      INTEGER UROTZZ 
      INTEGER UATRANX 
      INTEGER UATRANY 
      INTEGER UATRANZ 
      INTEGER UATRANW 
      INTEGER UAROTX  
      INTEGER UAROTY  
      INTEGER UAROTZ  
      INTEGER UASCALX 
      INTEGER UASCALY 
      INTEGER UASCALZ 
      INTEGER UASCALW 
      INTEGER USCALEX 
      INTEGER USCALEY
      INTEGER USCALEZ
      INTEGER USCALEW
      INTEGER UITRNSP
      INTEGER UISPEC
      INTEGER UIDIFF
      INTEGER UIAMBI
      INTEGER UISHIN
      INTEGER UIEMIS
      INTEGER UCHUE  
      INTEGER UCSAT  
      INTEGER UCVAL  
      INTEGER UFRAME 
      INTEGER UFRAMI 
      INTEGER SUMMARY
C
C       ADDITIONAL INTEGERS FOR THE WORLD-UNIQUE TFM'S.
C
      INTEGER WMOVEX 
      INTEGER WMOVEY 
      INTEGER WMOVEZ 
      INTEGER WMOVEW 
      INTEGER WWINDS
      INTEGER WWINDV
      INTEGER WWINDP
      INTEGER WWINDA
      INTEGER WWINDH
      INTEGER WWINDY
      INTEGER WFOG
      INTEGER WDEPTH
      INTEGER WWINDE
      INTEGER WWINDW
      INTEGER WSUMMRY
C)
      PARAMETER (UTRANX  = 1)
      PARAMETER (UTRANY  = 2)
      PARAMETER (UTRANZ  = 3)
      PARAMETER (UTRANW  = 4)
      PARAMETER (UROTXX  = 5)
      PARAMETER (UROTYY  = 6)
      PARAMETER (UROTZZ  = 7)
      PARAMETER (UATRANX = 8)
      PARAMETER (UATRANY = 9)
      PARAMETER (UATRANZ = 10)
      PARAMETER (UATRANW = 11)
      PARAMETER (UAROTX  = 12)
      PARAMETER (UAROTY  = 13)
      PARAMETER (UAROTZ  = 14)
      PARAMETER (UASCALX = 15)
      PARAMETER (UASCALY = 16)
      PARAMETER (UASCALZ = 17)
      PARAMETER (UASCALW = 18)
      PARAMETER (USCALEX = 19)
      PARAMETER (USCALEY = 20)
      PARAMETER (USCALEZ = 21)
      PARAMETER (USCALEW = 22)
      PARAMETER (UITRNSP = 23)
      PARAMETER (UIAMBI  = 24)
      PARAMETER (UISPEC  = 25)
      PARAMETER (UIDIFF  = 26)
      PARAMETER (UISHIN  = 27)
      PARAMETER (UIEMIS  = 28)
      PARAMETER (UCHUE   = 29)
      PARAMETER (UCSAT   = 30)
      PARAMETER (UCVAL   = 31)
      PARAMETER (UFRAME  = 32)
      PARAMETER (UFRAMI  = 33)
      PARAMETER (SUMMARY = 34)
C
C       ADDITIONAL PARAMETERS FOR THE WORLD-UNIQUE TFM'S.
C
      PARAMETER (WMOVEX  = 1)
      PARAMETER (WMOVEY  = 2)
      PARAMETER (WMOVEZ  = 3)
      PARAMETER (WMOVEW  = 4)
      PARAMETER (WWINDS  = 5)
      PARAMETER (WWINDV  = 6)
      PARAMETER (WWINDP  = 7)
      PARAMETER (WWINDA  = 8)
      PARAMETER (WWINDH  = 9)
      PARAMETER (WWINDY  = 10)
      PARAMETER (WFOG    = 11)
      PARAMETER (WDEPTH  = 12)
      PARAMETER (WWINDE  = 13)
      PARAMETER (WWINDW  = 14)
      PARAMETER (WSUMMRY = 15)
